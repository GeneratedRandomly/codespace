# 网安导 4-10 章作业
## 第四章
1. **公钥密码的出现解决了对称加密算法的什么问题？但对称加密至今仍被广泛使用，请简述对称密码与公钥密码各有何优缺点？**
   - **公钥密码解决的问题**：  
    公钥密码解决了密钥分发问题。
   - **对称密码的优缺点**：  
    对称密码加解密速度快，算法实现简单，计算开销小。缺点是密钥分发不够安全，且每对通信双方需要单独的密钥，管理复杂。
   - **公钥密码的优缺点**：  
    公钥密码解决了密钥分发问题，公钥可以公开传播，还支持数字签名和身份认证功能。缺点是加解密速度较慢，算法复杂，计算开销大。
2. **散列函数应该满足哪些条件？消息认证码与散列函数的生成过程有何区别？**
   - **散列函数的条件**：  
      1. 输入长度任意，输出长度固定。
      2. 计算简单高效，适合大规模数据处理。
      3. 单向性：从输出难以反推出输入。
      4. 抗碰撞性：难以找到两个不同的输入具有相同的输出。
   - **消息认证码与散列函数的生成过程区别**：  
      1. 散列函数是单向函数，仅对输入数据进行摘要计算，不涉及密钥。  
      2. 消息认证码在生成过程中需要一个密钥，结合输入数据和密钥生成认证码，用于验证消息的完整性和真实性。
## 第五章
1. **请从基本思想、隐私保护水平等角度分析比较差分隐私与匿名化的不同，并举例说明**
   - **基本思想**：  
       - 匿名化：通过泛化和隐藏准标识符，抵抗链接攻击，保护隐私。  
       - 差分隐私：严格化、科学化，通过在数据查询结果中引入随机噪声，确保单个数据的加入或移除不会显著影响结果，从而保护隐私。  
   - **隐私保护水平**：  
     - 匿名化：隐私保护水平较低，容易受到重识别攻击（如通过交叉引用其他数据集重新识别个人）。  
     - 差分隐私：隐私保护水平较高，能够提供严格的数学保障，即使攻击者拥有外部信息，也难以推断单个数据的存在或内容。  
   - **举例说明**：  
     - 匿名化：在发布医疗数据时，移除患者的姓名和身份证号，但如果数据中包含年龄、性别、住址等信息，可能通过其他数据集重新识别患者身份。  
     - 差分隐私：在统计某地区的平均收入时，向结果中添加随机噪声，使得攻击者无法确定某个具体个体的收入是否包含在统计中。  
2. **安全多方计算主要用于解决什么问题？具有哪些特点？**
   - **解决的问题**：  
    安全多方计算确保协作计算各方在不泄露自身输入数据的前提下，能够共同完成计算并获得正确的结果。例如，多个公司希望联合分析数据，但又不希望泄露各自的商业机密。
   - **特点**：  
     1. 隐私性：各方除计算结果外无法得到任何其他信息。
     2. 正确性：协议保证计算结果是正确的。
     3. 输入独立性：各方独立输入，不能基于其他参与者的输入选择自己的输入。
## 第六章
1. **请简要描述侧信道分析的原理，并简述其用于硬件木马检测的原理**
   - **侧信道分析的原理**：  
    侧信道分析通过捕获和分析设备在执行加密操作时泄露的物理信息（如功耗、电磁辐射、运行时间等）来推断密钥或其他敏感信息，无需直接访问设备内部数据。
   - **用于硬件木马检测的原理**：  
    硬件木马通常会改变电路的功耗、延迟或电磁特性。通过侧信道分析，可以捕获硬件在正常运行和被植入木马后的物理特性差异。例如，比较功耗或电磁信号的模式，检测是否存在异常，从而识别硬件木马的存在。这样应可检测出 MOLES 木马。
2. **请简要描述VoltJockey攻击的原理、过程及结果**
   - **原理**：  
    VoltJockey攻击是一种基于电压故障注入的攻击方法。攻击者通过动态调整处理器的供电电压，诱导处理器在执行指令时发生错误，从而破坏正常的计算流程，进而利用这些错误来绕过安全机制或泄露敏感信息。
   - **过程**：  
     1. 攻击者操作电压频率管理器，控制处理器的供电电压。
     2. 在关键指令执行时，降低电压，破坏时序约束，以引发位翻转。
     3. 结合故障差分技术打破可信域。  
   - **结果**：  
     VoltJockey攻击可以打破系统可信环境，获取敏感信息。
## 第七章
1. **请列出并简要介绍四种堆区攻击方案**
   - **堆溢出攻击**：通过向堆区写入超出分配空间的数据，覆盖相邻内存区域，从而修改程序的控制流或敏感数据。  
   - **Use-After-Free攻击**：利用程序释放内存后未清除指针的漏洞，攻击者可以通过悬空指针访问或修改已释放的内存。  
   - **Double-Free攻击**：当程序多次释放同一堆块，攻击者可以利用该漏洞实现堆块覆盖。
   - **Heap Over-Read攻击**：越界窃取堆区数据，比如心脏滴血攻击是由于未校验心跳包，导致私钥泄露。
2. **请简述面向返回地址编程(ROP)和全局偏置表劫持攻击(GOT Hijacking)的原理，并分析他们能否绕过以下三种内存防御机制，并简述原因**
   - **ROP攻击原理**：  
     ROP通过利用程序中已有的代码片段（称为“gadget”）构造恶意指令序列，避免直接注入代码，从而绕过不可执行内存区域的限制。  
   - **GOT劫持攻击原理**：  
     GOT劫持通过修改全局偏移表（GOT）中的函数指针，将库函数重定向到攻击者指定的库函数，从而执行恶意代码。  
   - **绕过内存防御机制分析**：  
     - **W^X (Write XOR eXecution)**：  
       - **ROP**：可以绕过，因为ROP不需要注入新代码，而是利用已有的可执行代码片段。  
       - **GOT劫持**：可以绕过，因为库函数可执行，且GOT表可读可写。
     - **ASLR (Address Space Layout Randomization)**：  
       - **ROP**：可以绕过，因为ASLR随机化基地址，不影响代码段。  
       - **GOT劫持**：可以绕过，因为ASLR不会随机化代码段，仍可通过PLT表恶意读取GOT表，得到动态库函数地址。
     - **Stack Canary**：  
       - **ROP**：无法绕过Stack Canary，需要信息泄露或暴力破解。
       - **GOT劫持**：可以绕过，因为GOT劫持不依赖栈上的数据，Stack Canary无法检测到此类攻击。  
## 第八章
1. **请描述off-path类型的攻击者在劫持一个目标TCP连接时，需要具备哪些能力？攻击者在注入伪造的报文时，需要猜测出TCP header里面的哪些字段，原因是什么？**
   - **攻击者需要具备的能力**：  
     1. 能够识别TCP连接四元组。 
     2. 能够伪造并发送符合TCP协议的报文。  
     3. 能够快速猜测并验证TCP序列号，以确保伪造的报文被目标接收方接受。  
   - **需要猜测的TCP header字段及原因**：  
     1. **源端口号**：四元组中Src IP、Dst IP、Dst port都是确定且已知的，而源端口号是随机的。
     2. **序列号和应答号**：确保在接收窗口之内，以免被丢弃；Seq和Ack一般都是相对于某随机数的offset。
2. **结合几个针对DNS域名服务实施的DDoS攻击案例分析提升DDoS攻击防御能力的可行措施**
   - **案例分析**：  
     1. **攻击.cn顶级服务器**：2013年8月25日凌晨，.CN域名凌晨出现大范围解析故障，导致大面积.CN域名无法解析，直到当日凌晨4点左右，CN根域名服务器解析才开始部分恢复
     2. **物联网设备攻击特定服务器**：2016年，攻击者控制大量物联网设备发起DDoS攻击，造成CNN,BBC,PayPal等网站无法访问。
   - **提升DDoS攻击防御能力的可行措施**：
     1. **启用DNSSEC**：通过DNSSEC验证DNS数据的完整性和真实性，防止伪造的DNS响应被接受。  
     2. **启用DoT、DoH**：直接使用传输层/应用层安全协议对数据执行加密操作，保证了域名协议交互中信息的完整性与机密性。
     3. **启用速率限制**：对DNS查询请求设置速率限制，防止单一来源发送过多请求。  
     4. **端口随机化**：增加端口猜测难度。
     5. **恶意流量过滤**：在网络入口处部署流量清洗设备，实时检测并过滤异常流量。  
     6. 
     7. **分布式部署**：通过Anycast将流量分散到多个地理位置的服务器，减轻单点压力。
## 第九章
1. **简述一下BGPsec的流程与基本理念。相比BGPsec，FC-BGP在哪些方面取得了改进？**
   - **BGPsec的流程与基本理念**：  
     BGPsec基本理念是保护AS路径传播过程，防止恶意插入有效起源和路径劫持。
     - 每个自治系统（AS）在转发路由通告时，会对通告中的路径信息进行数字签名。  
     - 接收方通过验证签名，确保路径信息未被篡改，并确认通告来自合法的AS。  
   - **FC-BGP的改进**：  
     FC-BGP（Forwarding Commitment BGP）在BGPsec的基础上进行了以下改进：
     1. **减少开销**：改为逐段验证，完全部署时相同的安全收益，与更低的验证开销。
     2. **增强灵活性**：兼容部分部署场景，提供此场景下明确的安全收益
2. **说明“域内路由安全”和“域间路由安全”的目标及主要威胁**
   - **域内路由安全目标及主要威胁**：  
     - **目标**：  
       1. 防范针对OSPF的攻击，防止虚假LSA公告。
     - **主要威胁**：  
       1. **Periodic injection 攻击**：不断虚构LSA公告，压制fight-back。
       2. **Disguised LSA 攻击**：预测源合法路由器发送的 fight-back 报文 Sequence Number, Checksum 和 Age 三个字段，屏蔽后续 fight-back 报文。
   - **域间路由安全目标及主要威胁**：  
     - **目标**：  
       1. 确保跨自治系统的路由通告的真实性和完整性。  
       2. 防止路由劫持和伪造。  
     - **主要威胁**：  
       1. **路由劫持**：恶意AS伪造路由通告，劫持前缀、子前缀、路径。
       2. **路由泄露**：将本应仅限于域内的路由信息泄露到域外，导致安全风险。  
3. **请简要阐述OSPF协议中用于抵御虚假通告的安全机制，并说明进一步的安全增强方案**
   - **安全机制**：  
     当一个域内路由器接收到了自称由该路由器产生的一条LSA通告，且通告内容与该路由器当前实际的路由状态信息不一致时，该路由器会重新发送一条新LSA通告以覆盖这条错误的旧LSA通告。此过程被称为Fight Back机制。
   - **进一步的安全增强方案**：  
     1. **区分配置链路密钥**：进行区分式链路密钥配置，即为不同的链路配置不同的密钥。
     2. **LSA不可预测**：在LSA通告中增加一个由随机数值所组成的虚拟链路字段。该字段可以影响LSA通告的checksum计算，使得LSA通告无法被攻击者预测。
     3. **LSA通告验证机制完善**：LSA三个字段相同，则进一步比较两通告的哈希值验证字段，避免Disguised LSA。
     4. **最大序列号、年龄完善**：当LSA通告的sequence number或age达到最大值时，路由器应当首先清除该LSA通告来防止攻击者基于sequence number或age伪造的攻击方式，随后再发送新的LSA通告。
     5. **指定路由器机制的完善**：当两个域内路由器尝试建立链路关系时，从路由器需验证主路由器是否查看了消息内容。该机制可以有效防范伪造虚拟路由器攻击。
     6. 此外，还可以进行路由验证、源地址验证等。
## 第十章
1. **DNS安全问题产生的根本原因是什么？**
   - **根本原因**：  
     1. 客观上协议设计的不完备，缓存等面向性能优化的设计带来了安全风险
     2. 主观上基于利益驱动，攻击者不断挖掘漏洞
2. **简述DNS缓存策略在性能提升和引入安全威胁上具有的影响**
   - **性能提升**：  
     1. **减少查询延迟**：通过缓存DNS解析结果，用户可以快速获取域名对应的IP地址，减少查询时间。  
     2. **降低服务器负载**：缓存减少了对上游DNS服务器的查询次数，减轻了根服务器和权威服务器的压力。  
     3. **提高可用性**：在上游服务器不可用时，缓存可以提供最近的解析结果，保证服务的连续性。  
   - **引入的安全威胁**：  
     1. **本地缓存中毒攻击**：在伪造回复中，把主机名映射到攻击地址，或者伪造权威服务器，将ns.attack.com放在授权部分欺骗DNS服务器，都可能导致域名IP对应遭到篡改。
     2. **远程缓存中毒攻击**：在权威区和附加区实施欺骗，造成严重DNS安全事件。
3. **如何评价“由于中国没有根域名服务器，网络控制权掌握在其他国家手里十分危险”的观点？**
   - **评价**： 
   - 该观点有一定的合理性，但过于夸大了根域名服务器控制权的影响。虽然根域名服务器在 DNS 解析体系中处于核心地位，但中国通过建立镜像服务器、发展自己的域名解析技术（如中文域名系统）等措施，在一定程度上保障了国内网络的正常运行和安全。根域名服务器主要负责顶级域名的解析，实际的域名解析大多由本地DNS服务器完成，根服务器的作用有限。同时，全球的域名解析体系是一个分布式的协作系统，并非由某个国家完全掌控。当然，网络基础设施的自主可控确实重要，应关注本土网络安全能力的提升。